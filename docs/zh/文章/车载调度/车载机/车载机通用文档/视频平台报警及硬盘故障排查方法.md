---
sidebar: heading
prev:
  text: 无
  link: 无
next:
  text: 无
  link: 无
---

# 视频平台报警及硬盘故障排查方法

## 一、**硬盘故障排查方式**

### 1、**查看设备故障日志**

终端报警数据展示位于综合视频平台故障日志管理下设备故障日志管理、设备故障统计中，其中设备故障日志管理展示设备目前存在的告警，设备故障统计管理展示终端已上传的所有告警记录。

![视频平台](/articles/视频平台报警及硬盘故障排查方法/视频平台.png )

### 2、**故障类型说明**

目前报警状态中，对录像产生影响的故障有：

* 磁盘损坏
* 分区丢失
* 磁盘不录像
* 磁盘丢失
* 分区损坏
* 磁盘通信错误
* 磁盘主线错误
* 磁盘识别错误
* 磁盘写入错误
* 磁盘介质错误
* 磁盘驱动错误

遇到此类故障，需要尽快进行维修处理。

### 3、**筛选故障设备**

> 可在故障类型中筛选故障。

::: warning 
以下列表中车辆代表设备目前故障状态，需要立即进行处理。 
:::

#### ①、**硬盘通信错误**

![硬盘通信错误](/articles/视频平台报警及硬盘故障排查方法/硬盘通信错误.png )

#### ②、**硬盘识别错误** 

![硬盘识别错误](/articles/视频平台报警及硬盘故障排查方法/硬盘识别错误.png )

#### ③、**硬盘写入超时错误**

![硬盘写入超时错误](/articles/视频平台报警及硬盘故障排查方法/硬盘写入超时错误.png )

#### ④、**磁盘介质错误**

![磁盘介质错误](/articles/视频平台报警及硬盘故障排查方法/磁盘介质错误.png )

#### ⑤、**磁盘驱动错误**

![磁盘驱动错误](/articles/视频平台报警及硬盘故障排查方法/磁盘驱动错误.png )

### 4、**查看历史故障统计**

::: warning
由于部分车辆，硬盘可能工作在不稳定状态，有时候工作正常，有时候工作不正常的情况，此种状态，平台会产生大量报警，此种情况录像也存在较大风险，也需要进行立即处理。
:::

![故障数量多](/articles/视频平台报警及硬盘故障排查方法/故障数量多.png )

## 二、**故障日志及解决方案**

```bash
av日志文件:  
①、/tmp/av_dbg.txt
②、/mnt/nand/log/av.txt*
③、/mnt/log/av.txt

linux命令：
cat /tmp/av_dbg.txt | grep 'type:' -i | more
```

### 1、**硬盘锁开【4】**

**状态代码：** 【type：4 -> 锁状态】 

**报警原因：** 硬盘锁状态。

* **off：** 硬盘锁关闭；

* **on：** 硬盘锁打开。

![硬盘锁开](/articles/视频平台报警及硬盘故障排查方法/硬盘锁开.png )

**报警描述：** type:4 state:on time:2023-03-22 05:44:31 param: description:

**解决方案：** 检查硬盘锁或者硬盘锁插件。

### 2、**视频丢失【6】**

![视频丢失](/articles/视频平台报警及硬盘故障排查方法/视频丢失.png )

![视频丢失日志](/articles/视频平台报警及硬盘故障排查方法/视频丢失日志.png )

**状态代码：** 【type：6 -> 摄像头状态】 

* **ok：** 视频正常；

* **loss：** 视频丢失。

**报警原因：** 无摄像机接入。

**报警描述：** type:6 state:loss time:2023-03-22 05:44:31 param: description:

**解决方式：** 检查摄像机或关闭不录像通道。

### 3、**磁盘损坏【7】** 

**状态代码：** 【type：7 -> 存储介质分区状态】 

**报警原因：** 硬盘初始化所有分区索引错误。

**报警描述：** 暂无

**解决方案：** 格式化硬盘

### 4、**存储介质高温【8】**

**状态代码：** 【type：8 -> 存储介质温度状态】 

**报警原因：** 硬盘温度异常。

**报警描述：** 暂无

**解决方式：** 尝试更换硬盘或者主机。

### 5、**分区丢失【9】**

**状态代码：** 【type：9 -> 存储介质挂载状态】 

**报警原因：** 硬盘挂载失败或硬盘分区只读上报告警。

**报警描述：** 暂无

**解决方案：** 格式化硬盘

### 6、**磁盘不录像【10】**

**状态代码：** 【type：10 -> 存储介质挂载状态】 

**报警原因：** 通道写录像出错上报告警，写正常后消警。

**报警描述：** type:10  state:off time:2023-03-22 05:44:31 param: description:

**解决方式：**  检查硬盘

### 7、**磁盘丢失【11】**

**状态代码：** 【type：11 -> 存储介质丢失】 

**报警原因：** 上电3-4min未识别到硬盘。

**报警描述：** 暂无

**解决方案：** 检查硬盘盒

### 8、**磁盘通信错误【13】**

![磁盘通信错误-ATA](/articles/视频平台报警及硬盘故障排查方法/磁盘通信错误-ATA.png )

![磁盘通信错误-ATA日志](/articles/视频平台报警及硬盘故障排查方法/磁盘通信错误-ATA日志.png )

**状态代码：** 【type：13 -> ATA BUS ERROR】 

**报警原因：** ATA总线错误

**报警描述：** type:13 state:fail time:2023-03-22 06:13:49 param:hdd description:hdd

**解决方案：** 主机到硬盘之间的通路有问题，检查`硬盘`、或`主机内的SATA线束`、或`主机与硬盘盒间的接插件`，或`SATA新通讯板`。

### 9、**磁盘主线错误【14】**

未使用

### 10、**磁盘识别错误【15】**

![磁盘识别错误-平台](/articles/视频平台报警及硬盘故障排查方法/磁盘识别错误-平台.png )

![磁盘识别错误-日志](/articles/视频平台报警及硬盘故障排查方法/磁盘识别错误-日志.png )

**状态代码：** 【type：15 -> GIVING UP】 

**报警原因：** 硬盘多次识别后，不能识别

**报警描述：** type:15 state:fail time:2023-03-22 09:23:58 param:hdd description:hdd

**解决方案：**

①、硬盘盒通过USB线接入电脑，检查硬盘能否正常识别，如可识别，说明硬盘芯正常。

②、如不能识别，拆开硬盘盒，检查SATA连接线，如不能正常识别，检查内部连接以及硬盘芯。

### 11、**磁盘写入超时错误【16】**

![磁盘写入超时-平台](/articles/视频平台报警及硬盘故障排查方法/磁盘写入超时-平台.png )

![磁盘写入超时-日志](/articles/视频平台报警及硬盘故障排查方法/磁盘写入超时-日志.png )

**状态代码：** 【type：16 -> MEDIA ERROR】 

**报警原因：** 软件检测到媒体错误

**报警描述：** type:16 state:fail time:2023-03-22 17:03:41 param:hdd description:hdd

**解决方案：**

①、检查硬盘，通过电脑软件读取smart信息，扫描坏块，如工作时间过长或出现坏块，建议客户更换硬盘。

②、检查SATA连接线，如不能正常识别，检查内部连接以及硬盘芯。

### 12、**磁盘介质错误【17】**

![磁盘介质错误-平台](/articles/视频平台报警及硬盘故障排查方法/磁盘介质错误-平台.png )

![磁盘介质错误-日志](/articles/视频平台报警及硬盘故障排查方法/磁盘介质错误-日志.png )

**状态代码：** 【type：17 -> MEDIA ERROR】 

**报警原因：** 软件检测到媒体错误

**报警描述：** type:17 state:fail time:2023-03-22 06:05:30 param:hdd description:hdd

**解决方案：**

①、检查硬盘。

②、检测到介质错误，卷上可能存在坏扇区,将检查该卷以查看是否存在坏扇区，建议更换硬盘。

### 13、**磁盘驱动错误【18】**

![磁盘驱动错误-平台](/articles/视频平台报警及硬盘故障排查方法/磁盘驱动错误-平台.png )

![磁盘驱动错误-日志](/articles/视频平台报警及硬盘故障排查方法/磁盘驱动错误-日志.png )

**状态代码：** 【type：18 -> DEVICE ERROR】 

**报警原因：** 软件检测到内核DEVICE_ERROR

**报警描述 :**   type:18 state:fail time:2023-03-22 06:07:14 param:hdd description:hdd

**解决方案：**

①、更换硬盘测试。

②、拆开硬盘盒，检查硬盘中的SATA线、硬盘芯。

## **三、报警代码描述**

| 十六进制 | 十进制 | 描述 | 页面展示 | 上传规则 |
| --- | --- | --- | --- | --- |
| 0x01 | 1 | Acc状态 | Acc状态 | 不上传 |
| 0x02 | 2 | 电容状态   | 电容故障 | 不上传 |
| 0x03 | 3 | 主电状态 | 主电掉电 | 不上传 |
| 0x04 | 4 | 锁状态 | 硬盘锁开 | 变化立即上传 |
| 0x05 | 5 | Rtc状态 | RTC故障 | 不上传 |
| 0x06 | 6 | 摄像头状态 | 视频丢失 | 插上摄像头立刻上传，拔掉摄像头约10s后上传 |
| 0x07 | 7 | 存储介质分区状态 | 磁盘损坏 | 硬盘初始化所有分区索引错误，上报告警。下次初始化分区正常消警。 |
| 0x08 | 8 | 存储介质温度状态 | 存储介质高温 | 硬盘开机温度低于5，或运行时温度高于70上报告警。温度回归正常后消警。 |
| 0x09 | 9 | 存储介质挂载状态 | 分区丢失 | 硬盘挂载失败或硬盘分区只读上报告警。硬盘正常挂载且硬盘分区非只读消警。 |
| 0x0a | 10 | 存储介质录像状态 | 磁盘不录像 | 通道写录像出错上报告警，写正常后消警 |
| 0x0b | 11 | 存储介质丢失：类型有HDD,SSD,SD | 磁盘丢失 | 上电3-4min未识别到硬盘上报告警。硬盘正常挂载消警。 |
| 0x0c | 12 | 分区损坏 | 分区损坏 | 对应0x07消警 |
| 0x0d | 13 | ATA BUS ERROR | 磁盘通信错误 | 硬盘工作状态下，收到内核ATA_BUS_ERROR且发生写错误，上报告警。硬盘再次挂载成功消警。 |
| 0x0e | 14 | HOST BUS ERROR | 磁盘主线错误 | 硬盘工作状态下，收到内核ATA_BUS_ERROR且发生写错误，上报告警。硬盘再次挂载成功消警。 |
| 0x0f | 15 | GIVING UP | 磁盘识别错误 | 硬盘工作状态下，收到内核GIVING_UP且发生写错误，上报告警。硬盘再次挂载成功消警。 |
| 0x10 | 16 | TIMEOUT | 磁盘写入错误 | 硬盘工作状态下，收到内核TIMEOUT且发生写错误，上报告警。硬盘再次挂载成功消警。 |
| 0x11 | 17 | MEDIA ERROR | 磁盘介质错误 | 收到内核MEDIA_ERROR，立刻上报告警，硬盘再次挂载消警。 |
| 0x12 | 18 | DEVICE ERROR | 磁盘驱动错误 | 硬盘工作状态下，收到内核DEVICE_ERROR且发生写错误，上报告警。硬盘再次挂载成功消警。 |